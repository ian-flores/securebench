<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with securebench • securebench</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with securebench">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">securebench</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/securebench.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/testing-patterns.html">Guardrail Testing Patterns</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ian-flores/securebench/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started with securebench</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ian-flores/securebench/blob/main/vignettes/securebench.Rmd" class="external-link"><code>vignettes/securebench.Rmd</code></a></small>
      <div class="d-none name"><code>securebench.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="why-benchmark-guardrails">Why benchmark guardrails?<a class="anchor" aria-label="anchor" href="#why-benchmark-guardrails"></a>
</h2>
<p>Every guardrail in an AI agent system makes a binary decision: let
the input through, or block it. Getting that decision wrong has real
consequences, and the failure modes cut both ways.</p>
<p>A guardrail that is <strong>too strict</strong> blocks legitimate
user requests. Your agent becomes frustrating to use: users write normal
queries and get rejected. A support chatbot that flags “how do I delete
my account?” as a SQL injection attack is protecting nothing while
alienating everyone. This is the <strong>false alarm</strong> problem:
the guardrail cries wolf, and eventually people either abandon the
system or find ways to route around it.</p>
<p>A guardrail that is <strong>too loose</strong> lets attacks slip
through. Prompt injections reach your LLM, SQL injection payloads hit
your database, and code execution attacks run in your sandbox. This is
the <strong>missed attack</strong> problem, and in security contexts it
is almost always the more dangerous failure mode. One missed attack can
compromise an entire system; a hundred false alarms are merely
annoying.</p>
<p>Benchmarking quantifies this trade-off. Instead of guessing whether
your guardrail is “good enough,” you measure exactly how often it makes
each type of mistake. securebench evaluates any guardrail function
against a labeled dataset and computes the metrics that matter.</p>
</div>
<div class="section level2">
<h2 id="the-metrics-precision-recall-and-f1">The metrics: precision, recall, and F1<a class="anchor" aria-label="anchor" href="#the-metrics-precision-recall-and-f1"></a>
</h2>
<p>Three metrics capture the trade-off between false alarms and missed
attacks. You need to understand them before looking at benchmark
output.</p>
<p><strong>Precision</strong> answers: “Of everything the guardrail
flagged as an attack, how much actually was an attack?” A precision of
0.90 means 90% of the inputs the guardrail blocked were genuinely
dangerous, and 10% were false alarms. High precision means few false
alarms, which keeps the user experience smooth.</p>
<p><strong>Recall</strong> answers: “Of all actual attacks in the
dataset, how many did the guardrail catch?” A recall of 0.80 means the
guardrail caught 80% of threats and missed 20%. High recall means few
missed attacks, which keeps the system secure.</p>
<p><strong>F1 score</strong> is the harmonic mean of precision and
recall. Unlike a simple average, the harmonic mean penalizes imbalance:
a guardrail with 0.99 precision but 0.10 recall gets an F1 of 0.18, not
0.55. This makes F1 a single number that only looks good when
<em>both</em> precision and recall are strong.</p>
<p>In security applications, you typically prioritize recall (catching
threats) over precision (avoiding false alarms), but the right balance
depends on your context. An air-gapped code execution sandbox can
tolerate more false alarms than a customer-facing chatbot.</p>
</div>
<div class="section level2">
<h2 id="the-confusion-matrix">The confusion matrix<a class="anchor" aria-label="anchor" href="#the-confusion-matrix"></a>
</h2>
<p>All four metrics come from a 2x2 confusion matrix. Here is how it
maps to security outcomes:</p>
<pre><code>                        Actual Status
                   +-----------+-----------+
                   |  Dangerous |   Safe    |
        +----------+-----------+-----------+
 Guard  | Blocked  |  TRUE     |  FALSE    |
 rail   |          |  POSITIVE |  ALARM    |
 Said:  +----------+-----------+-----------+
        | Passed   |  MISSED   |  TRUE     |
        |          |  ATTACK   |  NEGATIVE |
        +----------+-----------+-----------+</code></pre>
<p>Reading each cell:</p>
<ul>
<li>
<strong>True Positive (top-left):</strong> The input was dangerous
and the guardrail blocked it. This is the ideal outcome for
threats.</li>
<li>
<strong>False Alarm (top-right):</strong> The input was safe but the
guardrail blocked it anyway. Annoying but not dangerous.</li>
<li>
<strong>Missed Attack (bottom-left):</strong> The input was
dangerous but the guardrail let it through. This is the worst outcome in
security contexts.</li>
<li>
<strong>True Negative (bottom-right):</strong> The input was safe
and the guardrail let it through. This is the ideal outcome for
legitimate requests.</li>
</ul>
<p>The formulas:</p>
<ul>
<li>Precision = True Positives / (True Positives + False Alarms)</li>
<li>Recall = True Positives / (True Positives + Missed Attacks)</li>
<li>F1 = 2 * Precision * Recall / (Precision + Recall)</li>
</ul>
</div>
<div class="section level2">
<h2 id="quick-start-benchmark_guardrail">Quick start: benchmark_guardrail()<a class="anchor" aria-label="anchor" href="#quick-start-benchmark_guardrail"></a>
</h2>
<p>Now that you know what the numbers mean, here is how to compute them.
The fastest path is <code><a href="../reference/benchmark_guardrail.html">benchmark_guardrail()</a></code>, which takes a
guardrail function and two vectors: inputs that should be blocked and
inputs that should pass.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ian-flores.github.io/securebench/">securebench</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_guardrail</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">text</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"DROP TABLE|rm -rf"</span>, <span class="va">text</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/benchmark_guardrail.html">benchmark_guardrail</a></span><span class="op">(</span></span>
<span>  <span class="va">my_guardrail</span>,</span>
<span>  positive_cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DROP TABLE users"</span>, <span class="st">"rm -rf /"</span><span class="op">)</span>,</span>
<span>  negative_cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SELECT * FROM users"</span>, <span class="st">"Hello world"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">metrics</span><span class="op">$</span><span class="va">precision</span></span>
<span><span class="va">metrics</span><span class="op">$</span><span class="va">recall</span></span>
<span><span class="va">metrics</span><span class="op">$</span><span class="va">f1</span></span>
<span><span class="va">metrics</span><span class="op">$</span><span class="va">accuracy</span></span></code></pre></div>
<p>The <code>positive_cases</code> are inputs the guardrail should
<strong>block</strong> (dangerous), and <code>negative_cases</code> are
inputs it should <strong>pass</strong> (safe). securebench evaluates
each one, checks whether the guardrail got it right, and computes all
four metrics.</p>
</div>
<div class="section level2">
<h2 id="using-data-frames-for-more-control">Using data frames for more control<a class="anchor" aria-label="anchor" href="#using-data-frames-for-more-control"></a>
</h2>
<p>For larger or more structured test suites, pass a data frame with
<code>input</code> and <code>expected</code> columns. The
<code>expected</code> column uses the convention <code>TRUE</code> =
safe (should pass), <code>FALSE</code> = dangerous (should block):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  input <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal text"</span>, <span class="st">"safe query"</span>, <span class="st">"DROP TABLE x"</span>, <span class="st">"rm -rf /"</span><span class="op">)</span>,</span>
<span>  expected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"benign"</span>, <span class="st">"benign"</span>, <span class="st">"injection"</span>, <span class="st">"injection"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/guardrail_eval.html">guardrail_eval</a></span><span class="op">(</span><span class="va">my_guardrail</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/guardrail_metrics.html">guardrail_metrics</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="va">cm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/guardrail_confusion.html">guardrail_confusion</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p>The <code>label</code> column is optional but recommended; it helps
you see which <em>categories</em> of attack a guardrail struggles with
when you generate reports.</p>
</div>
<div class="section level2">
<h2 id="interpreting-results">Interpreting results<a class="anchor" aria-label="anchor" href="#interpreting-results"></a>
</h2>
<p>Once you have metrics, here is what they mean in practice:</p>
<table class="table">
<colgroup>
<col width="26%">
<col width="23%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Metric</th>
<th>Value</th>
<th>Interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Precision = 1.00</td>
<td>Perfect</td>
<td>Every block was justified, no false alarms</td>
</tr>
<tr class="even">
<td>Precision = 0.50</td>
<td>Concerning</td>
<td>Half of all blocks were false alarms</td>
</tr>
<tr class="odd">
<td>Recall = 1.00</td>
<td>Perfect</td>
<td>Every attack was caught</td>
</tr>
<tr class="even">
<td>Recall = 0.50</td>
<td>Dangerous</td>
<td>Half of all attacks slipped through</td>
</tr>
<tr class="odd">
<td>F1 = 1.00</td>
<td>Perfect</td>
<td>Both precision and recall are perfect</td>
</tr>
<tr class="even">
<td>F1 &lt; 0.70</td>
<td>Needs work</td>
<td>Significant imbalance or poor performance</td>
</tr>
</tbody>
</table>
<p>A common pattern: your guardrail has high recall but low precision
(catches everything, but also blocks too many safe inputs). The fix is
usually to make the detection patterns more specific. The reverse, high
precision with low recall, means the guardrail is confident when it
blocks but misses many threats. The fix is usually to add more detection
patterns.</p>
</div>
<div class="section level2">
<h2 id="reports">Reports<a class="anchor" aria-label="anchor" href="#reports"></a>
</h2>
<p>Generate formatted reports for interactive exploration or
programmatic analysis:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/guardrail_report.html">guardrail_report</a></span><span class="op">(</span><span class="va">result</span>, format <span class="op">=</span> <span class="st">"console"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/guardrail_report.html">guardrail_report</a></span><span class="op">(</span><span class="va">result</span>, format <span class="op">=</span> <span class="st">"data.frame"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<p>The console format prints a quick summary during development. The
data frame format lets you filter to specific failures, group by label,
or feed results into downstream analysis.</p>
</div>
<div class="section level2">
<h2 id="comparing-guardrails">Comparing guardrails<a class="anchor" aria-label="anchor" href="#comparing-guardrails"></a>
</h2>
<p>When you change a guardrail, you need to check that the change
actually helped and that nothing regressed.
<code><a href="../reference/guardrail_compare.html">guardrail_compare()</a></code> takes a baseline and a new result and
shows exactly what changed:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">improved_guard</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">text</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"DROP TABLE|rm -rf|DELETE FROM"</span>, <span class="va">text</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">result_v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/guardrail_eval.html">guardrail_eval</a></span><span class="op">(</span><span class="va">improved_guard</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/guardrail_compare.html">guardrail_compare</a></span><span class="op">(</span><span class="va">result</span>, <span class="va">result_v2</span><span class="op">)</span></span>
<span><span class="va">comparison</span><span class="op">$</span><span class="va">delta_f1</span></span>
<span><span class="va">comparison</span><span class="op">$</span><span class="va">improved</span></span>
<span><span class="va">comparison</span><span class="op">$</span><span class="va">regressed</span></span></code></pre></div>
<p>The <code>regressed</code> count is the most important field: if it
is greater than zero, the new guardrail broke something that previously
worked. Even a small regression in recall can mean a real attack vector
re-opened.</p>
</div>
<div class="section level2">
<h2 id="vitals-interop">Vitals interop<a class="anchor" aria-label="anchor" href="#vitals-interop"></a>
</h2>
<p>Export any guardrail as a vitals-compatible scorer for use in broader
LLM evaluation pipelines:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scorer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_vitals_scorer.html">as_vitals_scorer</a></span><span class="op">(</span><span class="va">my_guardrail</span><span class="op">)</span></span>
<span><span class="fu">scorer</span><span class="op">(</span><span class="st">"safe query"</span>, <span class="cn">TRUE</span><span class="op">)</span>    <span class="co"># 1 (correct)</span></span>
<span><span class="fu">scorer</span><span class="op">(</span><span class="st">"DROP TABLE x"</span>, <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># 1 (correct)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pipeline-benchmarking">Pipeline benchmarking<a class="anchor" aria-label="anchor" href="#pipeline-benchmarking"></a>
</h2>
<p>Evaluate a full multi-stage guardrail pipeline against a dataset:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pipeline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>run <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">text</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"DROP TABLE|rm -rf|eval\\("</span>, <span class="va">text</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/benchmark_pipeline.html">benchmark_pipeline</a></span><span class="op">(</span><span class="va">pipeline</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/guardrail_metrics.html">guardrail_metrics</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p>Use this when your production guardrail composes multiple checks
(prompt injection, SQL injection, code injection) and you want to
measure the accuracy of the whole chain.</p>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>For deeper testing patterns, including regression testing, version
comparison workflows, and advanced pipeline benchmarking, see
<code><a href="../articles/testing-patterns.html">vignette("testing-patterns")</a></code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ian Flores Siaca.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
